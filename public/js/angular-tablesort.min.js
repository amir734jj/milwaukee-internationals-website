var tableSortModule=angular.module("tableSort",[]);tableSortModule.provider("tableSortConfig",function(){this.filterTemplate="",this.filterFunction=void 0,this.paginationTemplate="",this.perPageOptions=[10,25,50,100],this.perPageDefault=this.perPageOptions[0],this.itemNameSingular="item",this.itemNamePlural=this.itemNameSingular+"s",this.noDataText="No "+this.itemNamePlural,this.wrappingElementClass="",isNaN(this.perPageDefault)||-1!==this.perPageOptions.indexOf(this.perPageDefault)||this.perPageOptions.push(this.perPageDefault),this.perPageOptions.sort(function(t,e){return t-e}),this.$get=function(){return this}}),tableSortModule.directive("tsWrapper",["$parse","$compile",function(t,e){"use strict";function r(t,e){return e.replace(/FILTER_STRING/g,"filtering.filterString").replace(/CURRENT_PAGE_RANGE/g,"pagination.getPageRangeString(TOTAL_COUNT)").replace(/TOTAL_COUNT/g,t.itemsArrayExpression+".length").replace(/PER_PAGE_OPTIONS/g,"pagination.perPageOptions").replace(/ITEMS_PER_PAGE/g,"pagination.perPage").replace(/ITEM_NAME_SINGULAR/g,"itemNameSingular").replace(/ITEM_NAME_PLURAL/g,"itemNamePlural").replace(/FILTERED_COUNT/g,"filtering.filteredCount").replace(/CURRENT_PAGE_NUMBER/g,"pagination.currentPage")}var i=function(){function t(t,e){return t>e?1:t<e?-1:0}var e=t,r=t;"object"==typeof Intl?e=new Intl.Collator(void 0,{sensitivity:"case"}).compare:"function"==typeof String.prototype.localeCompare&&(e=function(t,e){return(t+"").localeCompare(e,void 0,{sensitivity:"case"})});return function(t,i){return"number"==typeof t&&"number"==typeof i?r(t,i):t instanceof Date&&i instanceof Date?r(t.getTime(),i.getTime()):e(t,i)}}();return{scope:!0,controller:["$scope","tableSortConfig",function(e,r){e.pagination={template:r.paginationTemplate,perPageOptions:r.perPageOptions.concat(),perPage:r.perPageDefault,currentPage:1,getPageRangeString:function(t){var r=t!==e.filtering.filteredCount?e.filtering.filteredCount:t,i=Math.max((e.pagination.currentPage-1)*e.pagination.perPage+1,1),a=Math.min(e.pagination.currentPage*e.pagination.perPage,r);return 0===e.filtering.filteredCount?"":(a===r&&1===i?"":i+"-")+a}},e.filtering={template:r.filterTemplate,filterString:"",filterFunction:r.filterFunction,filteredCount:0,filterFields:[]},e.itemsArrayExpression="",e.itemNameSingular=r.itemNameSingular,e.itemNamePlural=r.itemNamePlural,e.noDataText=r.noDataText,e.wrappingElementClass=r.wrappingElementClass,e.sortExpression=[],e.headings=[];var i=function(e,r){return[t(e),null,!1,r||e]};this.setSortField=function(t,r,a,n){var s,o=i(t,a);if(o.push(n),1===e.sortExpression.length&&e.sortExpression[0][0]===o[0])e.sortExpression[0][2]?(r.removeClass("tablesort-desc"),r.addClass("tablesort-asc"),e.sortExpression[0][2]=!1):(r.removeClass("tablesort-asc"),r.addClass("tablesort-desc"),e.sortExpression[0][2]=!0),e.$emit("tablesort:sortOrder",[{name:e.sortExpression[0][3],order:e.sortExpression[0][2]}]);else{for(s=0;s<e.headings.length;s+=1)e.headings[s].removeClass("tablesort-desc").removeClass("tablesort-asc");r.addClass("tablesort-asc"),e.sortExpression=[o],e.$emit("tablesort:sortOrder",[{name:o[3],order:o[2]}])}},this.addSortField=function(t,r,a,n){var s,o=!1,l=i(t,a);for(l.push(n),s=0;s<e.sortExpression.length;s+=1)e.sortExpression[s][0]===l[0]&&(e.sortExpression[s][2]?(r.removeClass("tablesort-desc"),r.addClass("tablesort-asc"),e.sortExpression[s][2]=!1):(r.removeClass("tablesort-asc"),r.addClass("tablesort-desc"),e.sortExpression[s][2]=!0),o=!0);o||(r.addClass("tablesort-asc"),e.sortExpression.push(l)),e.$emit("tablesort:sortOrder",e.sortExpression.map(function(t){return{name:t[3],order:t[2]}}))},this.setTrackBy=function(t){e.trackBy=t},this.registerHeading=function(t){e.headings.push(t)},this.addFilterField=function(t,r){var a=i(t);e.filtering.filterFields.push(a)},this.setArrayExpr=function(t){e.itemsArrayExpression=t}}],link:function(a,n,s,o){function l(t){try{var e=a.$eval(t);return e||t}catch(e){return t}}if(s.tsItemName){var p="No "+a.itemNamePlural;a.itemNameSingular=l(s.tsItemName),s.tsItemNamePlural?a.itemNamePlural=l(s.tsItemNamePlural):a.itemNamePlural=l(s.tsItemName)+"s",s.tsNoDataText||a.noDataText!==p||(a.noDataText="No "+a.itemNamePlural)}if(s.tsNoDataText&&(a.noDataText=l(s.tsNoDataText)),s.tsWrappingElementClass&&(a.wrappingElementClass=s.tsWrappingElementClass),s.tsPerPageOptions&&(a.pagination.perPageOptions=a.$eval(s.tsPerPageOptions)),s.tsPerPageDefault){var u=a.$eval(s.tsPerPageDefault);isNaN(u)||(a.pagination.perPage=u,-1===a.pagination.perPageOptions.indexOf(a.pagination.perPage)&&(a.pagination.perPageOptions.push(a.pagination.perPage),a.pagination.perPageOptions.sort(function(t,e){return t-e})))}if(s.tsFilterFields)for(var g=s.tsFilterFields.split(",").filter(function(t){return t&&""!==t.trim()}),f=0;f<g.length;f+=1)o.addFilterField(g[f]);var c;if("false"!==s.tsDisplayFiltering&&""!==a.filtering.template&&a.filtering.filterFields.length>0){var d=r(a,a.filtering.template);c=e(d)(a),n.parent()[0].insertBefore(c[0],n[0])}s.tsFilterFunction&&(a.filtering.filterFunction=a.$eval(s.tsFilterFunction)),angular.isFunction(a.filtering.filterFunction)||(0===a.filtering.filterFields.length?a.filtering.filterFunction=function(t){return!0}:a.filtering.filterFunction=function(t){for(var e=!1,r=0;r<a.filtering.filterFields.length;r+=1)e||(e=(a.filtering.filterFields[r][0](t)||"").toString().toLowerCase().indexOf(a.filtering.filterString.toLowerCase())>-1);return e}),a.filterLimitFun=function(t){if(!s.tsFilterFunction&&""===a.filtering.filterString)return a.filtering.filteredCount=t.length,t;var e=t.filter(a.filtering.filterFunction);return a.filtering.filteredCount=e.length,e},a.sortFun=function(t,e){var r,n,s,o,l,p;for(r=0;r<a.sortExpression.length;r+=1){if(n=a.sortExpression[r][0](t),s=a.sortExpression[r][0](e),(l=e[a.sortExpression[r][1]])&&(n=l(n),s=l(s)),void 0!==n&&null!==n||(n=""),void 0!==s&&null!==s||(s=""),o=a.sortExpression[r][2],1===(p=(a.sortExpression[r][4]||i)(n,s)))return o?-1:1;if(-1===p)return o?1:-1}if(a.trackBy){if(n=t[a.trackBy],s=e[a.trackBy],void 0!==n&&null!==n||(n=""),void 0!==s&&null!==s||(s=""),1===(p=i(n,s)))return o?-1:1;if(-1===p)return o?1:-1}return 0},a.pageLimitFun=function(t){if("false"===s.tsDisplayPagination||""===a.pagination.template)return t;for(var e=(a.pagination.currentPage-1)*a.pagination.perPage,r=a.pagination.currentPage*a.pagination.perPage,i=[],n=0;n<t.length;n++)n>=e&&n<r&&i.push(t[n]);return i};var m;if("false"!==s.tsDisplayPagination&&""!==a.pagination.template){var h=r(a,a.pagination.template);m=e(h)(a),n.after(m)}var P;if(a.wrappingElementClass&&""!==a.wrappingElementClass&&(P=n.wrap("<div class='"+a.wrappingElementClass+"' />")),s.tsGetTableDataFunction){(0,t(s.tsGetTableDataFunction).assign)(a.$parent,function(e,r,i){var n=t(a.itemsArrayExpression)(a);return e&&(n=n.sort(a.sortFun)),r&&(n=a.filterLimitFun(n)),i&&(n=a.pageLimitFun(n)),n})}a.$on("$destroy",function(){c&&c.remove(),m&&m.remove(),P&&P.replaceWith(n)})}}}]),tableSortModule.directive("tsCriteria",function(){return{require:"^tsWrapper",scope:{tsOrderBy:"="},link:function(t,e,r,i){e[e.on?"on":"bind"]("click",function(a){t.$apply(function(){a.shiftKey?i.addSortField(r.tsCriteria,e,r.tsName,t.tsOrderBy):i.setSortField(r.tsCriteria,e,r.tsName,t.tsOrderBy)})}),e[e.on?"on":"bind"]("keypress",function(a){t.$apply(function(){13!==a.which&&32!==a.which||i.setSortField(r.tsCriteria,e,r.tsName,t.tsOrderBy)})}),e.addClass("tablesort-sortable"),"tsDefault"in r&&"0"!==r.tsDefault&&void 0!==r.tsDefault&&(i.addSortField(r.tsCriteria,e,r.tsName,t.tsOrderBy),"descending"===r.tsDefault&&i.addSortField(r.tsCriteria,e,r.tsName,t.tsOrderBy)),"tsFilter"in r&&i.addFilterField(r.tsCriteria,e),i.registerHeading(e)}}}),tableSortModule.directive("tsRepeat",["$compile","$interpolate",function(t,e){return{terminal:!0,multiElement:!0,require:"^tsWrapper",priority:1e6,link:function(r,i,a,n){for(var s=["ng-repeat","data-ng-repeat","ng-repeat-start","data-ng-repeat-start"],o=s[0],l="ts-repeat",p=0;p<s.length;p++)if(angular.isDefined(i.attr(s[p]))){l=(o=s[p]).replace(/^(data-)?ng/,"$1ts");break}var u="tablesortOrderBy:sortFun | tablesortLimit:filterLimitFun | tablesortLimit:pageLimitFun",g=i.attr(o),f=/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(\s+track\s+by\s+[\s\S]+?)?\s*$/,c=g.match(/\s+track\s+by\s+\S+?\.(\S+)/),d=g.match(f);if(c&&n.setTrackBy(c[1]),-1!==g.search(/tablesort/)?(g=g.replace(/tablesort/,u),c&&(g=g.replace(c[0],"")+c[0])):g=g.replace(f,"$1 in $2 | "+u+"$3"),angular.isUndefined(a.tsHideNoData)){var m=e.startSymbol(),h=e.endSymbol(),P=angular.element(i[0]).clone();P.removeAttr(o),P.removeAttr(l),P.addClass("showIfLast"),P.children().remove(),P.append('<td colspan="'+i[0].childElementCount+'">'+m+"noDataText"+h+"</td>"),P=t(P)(r),i.parent().prepend(P)}n.setArrayExpr(d[2]),angular.element(i[0]).attr(o,g),t(i,null,1e6)(r)}}}]),tableSortModule.filter("tablesortLimit",function(){return function(t,e){if(t)return e(t)}}),tableSortModule.filter("tablesortOrderBy",function(){return function(t,e){if(t)return t.concat().sort(e)}}),tableSortModule.filter("parseInt",function(){return function(t){return parseInt(t)||null}}),tableSortModule.filter("parseFloat",function(){return function(t){return parseFloat(t)||null}}),tableSortModule.filter("parseDate",function(){return function(t){var e=Date.parse(t);return isNaN(e)?null:e}});